ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_text_repel() +
geom_point() +
scale_y_continuous(limits = c(1, 2)) +
labs(x = "Public Spending on Family (% of GDP)",
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
plot_data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_text_repel() +
#geom_point() +
scale_y_continuous(limits = c(1, 2)) +
labs(x = "Public Spending on Family (% of GDP)",
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
plot_data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_text() +
scale_y_continuous(limits = c(1, 2)) +
labs(x = "Public Spending on Family (% of GDP)",
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
plot_data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_text() +
scale_y_continuous(limits = c(1, 2)) +
scale_x_continuous(limits = c(0, NA)) +
labs(x = "Public Spending on Family (% of GDP)",
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
plot_data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
scale_y_continuous(limits = c(1, 2)) +
scale_x_continuous(limits = c(0, NA)) +
labs(x = "Public Spending on Family (% of GDP)",
y = "Total Fertility Rate") +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
plot_data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
scale_y_continuous(limits = c(1, 2)) +
scale_x_continuous(limits = c(0, NA)) +
labs(x = "Public Spending on Family (% of GDP)",
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
plot_data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
scale_y_continuous(limits = c(0, 2)) +
scale_x_continuous(limits = c(0, NA)) +
labs(x = "Public Spending on Family (% of GDP)",
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
1
plot_data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
scale_y_continuous(limits = c(1, 2)) +
scale_x_continuous(limits = c(0, NA)) +
labs(x = "Public Spending on Family (% of GDP)",
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
plot_data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
scale_y_continuous(limits = c(1, 2)) +
scale_x_continuous(limits = c(0, NA)) +
stat_smooth(method = lm) +
labs(x = "Public Spending on Family (% of GDP)",
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
plot_data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
scale_y_continuous(limits = c(1, 2)) +
scale_x_continuous(limits = c(0, NA)) +
labs(x = "Public Spending on Family (% of GDP)",
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
plot_data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = family_spending_to_gdp, y = tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
scale_y_continuous(limits = c(1, 2)) +
labs(x = independent_vars_labels[i],
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
basic_scatter <- function(data, x_var, y_var, label) {
data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = .data[[x_var]], y = .data[[y_var]], label = country_code)) +
geom_point() +
geom_text_repel() +
scale_y_continuous(limits = c(1, 2)) +
labs(x = label,
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
basic_scatter(plot_data, "family_spending_to_gdp", "tfr", "Public Spending on Family Policies (% of GDP)")
basic_scatter <- function(data, x_var, label) {
data %>%
filter(country_code %in% peers) %>%
ggplot(aes(x = .data[[x_var]], y = tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
scale_y_continuous(limits = c(1, 2)) +
labs(x = label,
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
basic_scatter(plot_data, "family_spending_to_gdp", "Public Spending on Family Policies (% of GDP)")
for(i in 1:length(independent_vars)) {
figure <- basic_scatter(plot_data, independent_vars[i], independent_vars_labels[i])
path <- past0("figures/scatter_tfr_", independent_vars[i], ".csv")
path_overleaf <- past0("overleaf/scatter_tfr_", independent_vars[i], ".csv")
ggsave(filename = path, plot = figure, dpi = 320, width = 6, height = 5)
ggsave(filename = path_overleaf, plot = figure, dpi = 320, width = 6, height = 5)
}
independent_vars <- c("family_spending_to_gdp", "pc_family_spending_2015usd")
independent_vars_labels <- c("Public Spending on Family Policies (% of GDP)", "Per Capita Spending on Family Policies (2015 USD PPP)")
for(i in 1:length(independent_vars)) {
figure <- basic_scatter(plot_data, independent_vars[i], independent_vars_labels[i])
path <- past0("figures/scatter_tfr_", independent_vars[i], ".csv")
path_overleaf <- past0("overleaf/scatter_tfr_", independent_vars[i], ".csv")
ggsave(filename = path, plot = figure, dpi = 320, width = 6, height = 5)
ggsave(filename = path_overleaf, plot = figure, dpi = 320, width = 6, height = 5)
}
for(i in 1:length(independent_vars)) {
figure <- basic_scatter(plot_data, independent_vars[i], independent_vars_labels[i])
path <- paste0("figures/scatter_tfr_", independent_vars[i], ".csv")
path_overleaf <- past0("overleaf/scatter_tfr_", independent_vars[i], ".csv")
ggsave(filename = path, plot = figure, dpi = 320, width = 6, height = 5)
ggsave(filename = path_overleaf, plot = figure, dpi = 320, width = 6, height = 5)
}
for(i in 1:length(independent_vars)) {
figure <- basic_scatter(plot_data, independent_vars[i], independent_vars_labels[i])
path <- paste0("figures/scatter_tfr_", independent_vars[i], ".csv")
path_overleaf <- paste0("overleaf/scatter_tfr_", independent_vars[i], ".csv")
ggsave(filename = path, plot = figure, dpi = 320, width = 6, height = 5)
ggsave(filename = path_overleaf, plot = figure, dpi = 320, width = 6, height = 5)
}
o
for(i in 1:length(independent_vars)) {
figure <- basic_scatter(plot_data, independent_vars[i], independent_vars_labels[i])
path <- paste0("figures/scatter_tfr_", independent_vars[i], ".jpeg")
path_overleaf <- paste0("overleaf/scatter_tfr_", independent_vars[i], ".jpeg")
ggsave(filename = path, plot = figure, dpi = 320, width = 6, height = 5)
ggsave(filename = path_overleaf, plot = figure, dpi = 320, width = 6, height = 5)
}
# Generating scatter plots
peers <- c("ESP", "FRA", "DEU", "FIN", "NOR", "SWE", "GBR", "GRC", "JPN", "AUS", "CAN",
"DNK", "ITA", "NLD", "USA", "CHE", "BEL", "AUT", "IRL", "ISL", "CZE","PRT",
"POL")
basic_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
scale_y_continuous(limits = c(1, 2)) +
labs(x = label,
y = "Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
for(i in 1:length(independent_vars)) {
figure <- basic_scatter(plot_data, peers, independent_vars[i], independent_vars_labels[i])
path <- paste0("figures/scatter_tfr_", independent_vars[i], ".jpeg")
path_overleaf <- paste0("overleaf/scatter_tfr_", independent_vars[i], ".jpeg")
ggsave(filename = path, plot = figure, dpi = 320, width = 6, height = 5)
ggsave(filename = path_overleaf, plot = figure, dpi = 320, width = 6, height = 5)
}
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0, linetype = "dashed") +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0, linetype = "dashed") +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
View(oecd_data)
?geom_vline
?geom_vline()
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", linewidth = 0.1) +
geom_hline(yintercept = 0, linetype = "dashed", linewidth = 0.1) +
scale_x_continuous() +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", linewidth = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", linewidth = 0.025) +
scale_x_continuous() +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", linewidth = 0.001) +
geom_hline(yintercept = 0, linetype = "dashed", linewidth = 0.001) +
scale_x_continuous() +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", linewidth = 0.00001) +
geom_hline(yintercept = 0, linetype = "dashed", linewidth = 0.00001) +
scale_x_continuous() +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", size = 0.1) +
geom_hline(yintercept = 0, linetype = "dashed", size = 0.1) +
scale_x_continuous() +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", linewidth = 0.1) +
geom_hline(yintercept = 0, linetype = "dashed", linewidth = 0.1) +
scale_x_continuous() +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", linewidth = 1) +
geom_hline(yintercept = 0, linetype = "dashed", linewidth = 1) +
scale_x_continuous() +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", linewidth = 0.1) +
geom_hline(yintercept = 0, linetype = "dashed", linewidth = 0.1) +
scale_x_continuous() +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", linewidth = 0.1) +
geom_hline(yintercept = 0, linetype = "dashed", linewidth = 0.1) +
scale_y_continuous(limits = c(-0.3, 0.1)) +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", linewidth = 0.1) +
geom_hline(yintercept = 0, linetype = "dashed", linewidth = 0.1) +
scale_y_continuous(limits = c(-0.35, 0.1)) +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter <- function(data, countries, x_var, label) {
data %>%
filter(country_code %in% countries) %>%
ggplot(aes(x = .data[[x_var]], y = pct_change_tfr, label = country_code)) +
geom_point() +
geom_text_repel() +
geom_vline(xintercept = 0, linetype = "dashed", linewidth = 0.1) +
geom_hline(yintercept = 0, linetype = "dashed", linewidth = 0.1) +
scale_x_continuous(limits = c(-0.5, NA)) +
scale_y_continuous(limits = c(-0.35, 0.1)) +
labs(x = label,
y = "Change in Total Fertility Rate") +
theme_minimal() +
theme(axis.text = element_text(size = 10),
axis.line = element_line(),
axis.ticks = element_line(),
panel.grid = element_blank())
}
change_scatter(plot_data, peers, "pct_change_spending_to_gdp", "Change in Public Spending as % of GDP")
change_scatter(plot_data, peers, "pct_change_spending", "Change in Per Capita Spending")
View(oecd_data)
oecd_data %>%
filter(year %in% period) %>%
group_by(country_code) %>%
mutate(pct_change_spending = pc_family_spending_2015usd / lag(pc_family_spending_2015usd) - 1,
pct_change_spending_to_gdp = family_spending_to_gdp / lag(family_spending_to_gdp) - 1,
pct_change_tfr = (tfr / lag(tfr)) - 1) %>%
ungroup()
oecd_data %>%
filter(year %in% period) %>%
group_by(country_code) %>%
mutate(pct_change_spending = pc_family_spending_2015usd / lag(pc_family_spending_2015usd) - 1,
pct_change_spending_to_gdp = family_spending_to_gdp / lag(family_spending_to_gdp) - 1,
pct_change_tfr = (tfr / lag(tfr)) - 1) %>%
ungroup() %>% filter(country_code == "JPN")
oecd_data %>%
filter(year %in% period) %>%
group_by(country_code) %>%
mutate(pct_change_spending = pc_family_spending_2015usd / lag(pc_family_spending_2015usd) - 1,
pct_change_spending_to_gdp = family_spending_to_gdp / lag(family_spending_to_gdp) - 1,
pct_change_tfr = (tfr / lag(tfr)) - 1) %>%
ungroup() %>% filter(country_code == "JPN") %>% View()
independent_vars_c <- c("pct_change_spending_to_gdp", "pct_change_spending")
independent_vars_labels_c <- c("Change in Public Spending as % of GDP", "Change in Per Capita Spending")
for(i in 1:length(independent_vars_c)) {
figure <- change_scatter(plot_data, peers, independent_vars_c[i], independent_vars_labels_c[i])
path <- paste0("figures/scatter_tfr_", independent_vars_c[i], ".jpeg")
path_overleaf <- paste0("overleaf/scatter_tfr_", independent_vars_c[i], ".jpeg")
ggsave(filename = path, plot = figure, dpi = 320, width = 6, height = 5)
ggsave(filename = path_overleaf, plot = figure, dpi = 320, width = 6, height = 5)
}
path
