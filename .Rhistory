total_fertility %>%
filter(YEAR %in% c(2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
theme_minimal() +
theme(legend.position = "bottom") +
total_fertility %>%
filter(YEAR %in% c(2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
theme_minimal() +
theme(legend.position = "bottom")
total_fertility %>%
filter(YEAR %in% c(2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
theme_minimal() +
theme(legend.position = "bottom")
total_fertility %>%
filter(YEAR %in% c(2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
labs(fill = "Education:") +
theme_minimal() +
theme(legend.position = "bottom")
total_fertility %>%
filter(YEAR %in% c(2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
labs(y = "Children per woman",
fill = "Education:") +
theme_minimal() +
theme(legend.position = "bottom")
total_fertility %>%
filter(YEAR %in% c(2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
labs(y = "Children per woman",
fill = "Education:") +
theme_minimal() +
theme(legend.position = "bottom",
axis.text.x = element_blank())
total_fertility %>%
filter(YEAR %in% c(2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
labs(y = "Children per woman",
fill = "Education:") +
theme_minimal() +
theme(legend.position = "bottom",
axis.title.x = element_blank())
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(y = "Children per woman",
fill = "Education:") +
theme_minimal() +
theme(legend.position = "bottom",
axis.title.x = element_blank())
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age", y = "Children per woman",
fill = "Education:") +
theme_minimal() +
theme(legend.position = "bottom")
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Current Population Survey, Fertility Supplement") +
theme_minimal() +
theme(legend.position = "bottom")
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom")
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN_UNW, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom")
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN_UNW, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom",
axis.line = element_line())
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN_UNW, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_bw() +
theme(legend.position = "bottom")
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN_UNW, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom")
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom")
data_mothers_1980_2022 <- data %>%
filter(YEAR %in% c(1980, 1990, 1995, 2012, 2014, 2016, 2018, 2020, 2022),
SEX == 2,
!(FREVER %in% c(0, 999))) %>%
mutate(FRAGE = FRAGE1 / 12,
AGE_FIRST_BIRTH = case_when(FRAGE < 20 ~ "< 19",
FRAGE < 25 ~ "20-24",
FRAGE < 30 ~ "25-29",
FRAGE < 35 ~ "30-34",
FRAGE < 40 ~ "35-39",
FRAGE < 45 ~ "40-44",
TRUE ~ "> 45"),
EDUCATIONAL_LEVEL = case_when(EDUC %in% 2:32 ~ "Basic Education",
EDUC %in% 40:73 ~ "Secondary Education",
EDUC %in% 80:100 ~ "Tertiary Education",
EDUC %in% 110:125 ~ "University Degree"))
total_fertility <- data_mothers_1980_2022 %>%
group_by(YEAR, AGE_FIRST_BIRTH, EDUCATIONAL_LEVEL) %>%
summarise(CHILDREN_PER_WOMAN = weighted.mean(FREVER, WTFINL),
CHILDREN_PER_WOMAN_UNW = mean(FREVER)) %>%
ungroup()
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom")
data_mothers_1980_2022 <- data %>%
filter(YEAR %in% c(1980, 1990, 1995, 2012, 2014, 2016, 2018, 2020, 2022),
SEX == 2,
!(FREVER %in% c(0, 999))) %>%
mutate(FRAGE = FRAGE1 / 12,
AGE_FIRST_BIRTH = case_when(FRAGE < 20 ~ "< 19",
FRAGE < 25 ~ "20-24",
FRAGE < 30 ~ "25-29",
FRAGE < 35 ~ "30-34",
FRAGE < 40 ~ "35-39",
FRAGE < 45 ~ "40-44",
TRUE ~ "> 45"),
AGE_FIRST_BIRTH = fct_relevel(AGE_FIRST_BIRTH,
"< 19", "20-24", "25-29", "30-34", "35-39", "40-44", "> 45"),
EDUCATIONAL_LEVEL = case_when(EDUC %in% 2:32 ~ "Basic Education",
EDUC %in% 40:73 ~ "Secondary Education",
EDUC %in% 80:100 ~ "Tertiary Education",
EDUC %in% 110:125 ~ "University Degree"))
total_fertility <- data_mothers_1980_2022 %>%
group_by(YEAR, AGE_FIRST_BIRTH, EDUCATIONAL_LEVEL) %>%
summarise(CHILDREN_PER_WOMAN = weighted.mean(FREVER, WTFINL),
CHILDREN_PER_WOMAN_UNW = mean(FREVER)) %>%
ungroup()
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom")
# Saving CPS fertility dataset
path <- "refined/cps_total_fertility.csv"
# Saving CPS fertility dataset
path <- "refined/cps_total_fertility.csv"
write.csv(data_mothers_1980_2022, file = path)
# Saving CPS fertility dataset
path <- "refined/cps_total_fertility.csv"
write.csv(total_fertility, file = path)
# Installing required packages
packages <- c("tidyverse", "ipumsr")
to_install <- packages[!(packages %in% installed.packages()[,"Package"])]
if(length(to_install) > 0) install.packages(to_install)
lapply(packages, require, character.only = TRUE)
# Clean workspace
rm(list = ls())
# Set working directory
setwd("C:/Users/gustavoml/Desktop/Projects/FertilityFacts")
# Loading extract into R
ddi <- read_ipums_ddi("raw/cps_00002.xml")
data <- read_ipums_micro(ddi)
# Summarizing CPS data by age of first birth
data_mothers_1980_2022 <- data %>%
filter(YEAR %in% c(1980, 1990, 1995, 2012, 2014, 2016, 2018, 2020, 2022),
SEX == 2,
!(FREVER %in% c(0, 999))) %>%
mutate(FRAGE = FRAGE1 / 12,
AGE_FIRST_BIRTH = case_when(FRAGE < 20 ~ "< 19",
FRAGE < 25 ~ "20-24",
FRAGE < 30 ~ "25-29",
FRAGE < 35 ~ "30-34",
FRAGE < 40 ~ "35-39",
FRAGE < 45 ~ "40-44",
TRUE ~ "> 45"),
AGE_FIRST_BIRTH = fct_relevel(AGE_FIRST_BIRTH,
"< 19", "20-24", "25-29", "30-34", "35-39", "40-44", "> 45"),
EDUCATIONAL_LEVEL = case_when(EDUC %in% 2:32 ~ "Basic Education",
EDUC %in% 40:73 ~ "Secondary Education",
EDUC %in% 80:100 ~ "Tertiary Education",
EDUC %in% 110:125 ~ "University Degree"))
# Generating numbers for Fertility by Age at First Birth and Educational Attainment
total_fertility <- data_mothers_1980_2022 %>%
group_by(YEAR, AGE_FIRST_BIRTH, EDUCATIONAL_LEVEL) %>%
summarise(CHILDREN_PER_WOMAN = weighted.mean(FREVER, WTFINL),
CHILDREN_PER_WOMAN_UNW = mean(FREVER)) %>%
ungroup()
# Saving CPS fertility dataset
path <- "refined/cps_total_fertility.csv"
write.csv(total_fertility, file = path)
total_fertility %>%
filter(YEAR %in% (2012:2022)) %>%
ggplot(aes(x = YEAR, y = CHILDREN_PER_WOMAN, color = AGE_FIRST_BIRTH)) +
geom_line() +
geom_point() +
theme_minimal()
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom")
# Saving CPS fertility datasets
path_data_mothers_1980_2022 <- "refined/cps_fertility_1980_2022.csv"
path_total_fertility <- "refined/cps_total_fertility.csv"
write.csv(data_mothers_1980_2022, file = path_data_mothers_1980_2022)
write.csv(total_fertility, file = path_total_fertility)
# Installing required packages
packages <- c("tidyverse", "ipumsr")
to_install <- packages[!(packages %in% installed.packages()[,"Package"])]
if(length(to_install) > 0) install.packages(to_install)
lapply(packages, require, character.only = TRUE)
# Clean workspace
rm(list = ls())
# Set working directory
setwd("C:/Users/gustavoml/Desktop/Projects/FertilityFacts")
# Loading extract into R
ddi <- read_ipums_ddi("raw/cps_00002.xml")
data <- read_ipums_micro(ddi)
# Summarizing CPS data by age of first birth
data_mothers_1980_2022 <- data %>%
filter(YEAR %in% c(1980, 1990, 1995, 2012, 2014, 2016, 2018, 2020, 2022),
SEX == 2,
!(FREVER %in% c(0, 999))) %>%
mutate(FRAGE = FRAGE1 / 12,
AGE_FIRST_BIRTH = case_when(FRAGE < 20 ~ "< 19",
FRAGE < 25 ~ "20-24",
FRAGE < 30 ~ "25-29",
FRAGE < 35 ~ "30-34",
FRAGE < 40 ~ "35-39",
FRAGE < 45 ~ "40-44",
TRUE ~ "> 45"),
AGE_FIRST_BIRTH = fct_relevel(AGE_FIRST_BIRTH,
"< 19", "20-24", "25-29", "30-34", "35-39", "40-44", "> 45"),
EDUCATIONAL_LEVEL = case_when(EDUC %in% 2:32 ~ "Basic Education",
EDUC %in% 40:73 ~ "Secondary Education",
EDUC %in% 80:100 ~ "Tertiary Education",
EDUC %in% 110:125 ~ "University Degree"))
# Generating numbers for Fertility by Age at First Birth and Educational Attainment
total_fertility <- data_mothers_1980_2022 %>%
group_by(YEAR, AGE_FIRST_BIRTH, EDUCATIONAL_LEVEL) %>%
summarise(CHILDREN_PER_WOMAN = weighted.mean(FREVER, WTFINL),
CHILDREN_PER_WOMAN_UNW = mean(FREVER)) %>%
ungroup()
# Saving CPS fertility datasets
path_data_mothers_1980_2022 <- "refined/cps_fertility_1980_2022.csv"
path_total_fertility <- "refined/cps_total_fertility.csv"
write.csv(data_mothers_1980_2022, file = path_data_mothers_1980_2022)
write.csv(total_fertility, file = path_total_fertility)
# Load intermediate datasets
total_fertility <- read.csv("refined/cps_total_fertility.csv")
# Installing required packages
packages <- c("tidyverse", "viridis")
to_install <- packages[!(packages %in% installed.packages()[,"Package"])]
if(length(to_install) > 0) install.packages(to_install)
lapply(packages, require, character.only = TRUE)
# Clean workspace
rm(list = ls())
# Set working directory
setwd("C:/Users/gustavoml/Desktop/Projects/FertilityFacts")
# Load intermediate datasets
total_fertility <- read.csv("refined/cps_total_fertility.csv")
mothers_1980_2022 <- read.csv("refined/cps_fertility_1980_2022.csv")
## Total Fertility by Age of First Birth
mothers_1980_2022 %>%
filter(YEAR %in% (2012:2022)) %>%
group_by(YEAR, AGE_FIRST_BIRTH) %>%
summarise(CHILDREN_PER_WOMAN = weighted.mean(FREVER, WTFINL)) %>%
ungroup() %>%
ggplot(aes(x = YEAR, y = CHILDREN_PER_WOMAN, color = AGE_FIRST_BIRTH)) +
geom_line() +
geom_point() +
theme_minimal()
###########################################################################
# Script: extract_cps_fertility.R
# Author: Gustavo Luchesi
# Last Updated: 8/27/2024
# Description: Extracts CPS dat file from raw and creates intermediate datasets
# based on the Fertility Supplement of the CPS
# Input: cps_00002.dat
# Output: cps_total_fertility.csv and cps_fertility_1980_2022.csv
###########################################################################
# Installing required packages
packages <- c("tidyverse", "ipumsr")
to_install <- packages[!(packages %in% installed.packages()[,"Package"])]
if(length(to_install) > 0) install.packages(to_install)
lapply(packages, require, character.only = TRUE)
# Clean workspace
rm(list = ls())
# Set working directory
setwd("C:/Users/gustavoml/Desktop/Projects/FertilityFacts")
# Loading extract into R
ddi <- read_ipums_ddi("raw/cps_00002.xml")
data <- read_ipums_micro(ddi)
# Generating a dataset for mothers from 1980 - 2022
data_mothers_1980_2022 <- data %>%
filter(YEAR %in% c(1980, 1990, 1995, 2012, 2014, 2016, 2018, 2020, 2022),
SEX == 2,
!(FREVER %in% c(0, 999))) %>%
mutate(FRAGE = FRAGE1 / 12,
AGE_FIRST_BIRTH = case_when(FRAGE < 20 ~ "< 19",
FRAGE < 25 ~ "20-24",
FRAGE < 30 ~ "25-29",
FRAGE < 35 ~ "30-34",
FRAGE < 40 ~ "35-39",
FRAGE < 45 ~ "40-44",
TRUE ~ "> 45"),
AGE_FIRST_BIRTH = fct_relevel(AGE_FIRST_BIRTH,
"< 19", "20-24", "25-29", "30-34", "35-39", "40-44", "> 45"),
EDUCATIONAL_LEVEL = case_when(EDUC %in% 2:32 ~ "Basic Education",
EDUC %in% 40:73 ~ "Secondary Education",
EDUC %in% 80:100 ~ "Tertiary Education",
EDUC %in% 110:125 ~ "University Degree"))
# Generating numbers for Fertility by Age at First Birth and Educational Attainment
total_fertility <- data_mothers_1980_2022 %>%
group_by(YEAR, AGE_FIRST_BIRTH, EDUCATIONAL_LEVEL) %>%
summarise(CHILDREN_PER_WOMAN = weighted.mean(FREVER, WTFINL),
CHILDREN_PER_WOMAN_UNW = mean(FREVER)) %>%
ungroup()
# Saving CPS fertility datasets
path_data_mothers_1980_2022 <- "refined/cps_fertility_1980_2022.csv"
path_total_fertility <- "refined/cps_total_fertility.csv"
write.csv(data_mothers_1980_2022, file = path_data_mothers_1980_2022)
write.csv(total_fertility, file = path_total_fertility)
###########################################################################
# Script: cps_fertility_age_first_birth.R
# Author: Gustavo Luchesi
# Last Updated: 8/27/2024
# Description: Extracts CPS dat file from raw and creates intermediate datasets
# based on the Fertility Supplement of the CPS
# Input: cps_total_fertility.csv and cps_fertility_1980_2022.csv
# Output:
###########################################################################
# Installing required packages
packages <- c("tidyverse", "viridis")
to_install <- packages[!(packages %in% installed.packages()[,"Package"])]
if(length(to_install) > 0) install.packages(to_install)
lapply(packages, require, character.only = TRUE)
# Clean workspace
rm(list = ls())
# Set working directory
setwd("C:/Users/gustavoml/Desktop/Projects/FertilityFacts")
# Load intermediate datasets
total_fertility <- read.csv("refined/cps_total_fertility.csv")
mothers_1980_2022 <- read.csv("refined/cps_fertility_1980_2022.csv")
## Total Fertility by Age of First Birth
mothers_1980_2022 %>%
filter(YEAR %in% (2012:2022)) %>%
group_by(YEAR, AGE_FIRST_BIRTH) %>%
summarise(CHILDREN_PER_WOMAN = weighted.mean(FREVER, WTFINL)) %>%
ungroup() %>%
ggplot(aes(x = YEAR, y = CHILDREN_PER_WOMAN, color = AGE_FIRST_BIRTH)) +
geom_line() +
geom_point() +
theme_minimal()
## Total Fertility by Age of First Birth and Educational Level
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom")
## Total Fertility by Age of First Birth
mothers_1980_2022 %>%
filter(YEAR %in% (2012:2022)) %>%
mutate(AGE_FIRST_BIRTH = fct_relevel(AGE_FIRST_BIRTH,
"< 19", "20-24", "25-29", "30-34", "35-39", "40-44", "> 45")) %>%
group_by(YEAR, AGE_FIRST_BIRTH) %>%
summarise(CHILDREN_PER_WOMAN = weighted.mean(FREVER, WTFINL)) %>%
ungroup() %>%
ggplot(aes(x = YEAR, y = CHILDREN_PER_WOMAN, color = AGE_FIRST_BIRTH)) +
geom_line() +
geom_point() +
theme_minimal()
View(total_fertility)
## Total Fertility by Age of First Birth and Educational Level
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
mutate(AGE_FIRST_BIRTH = fct_relevel(AGE_FIRST_BIRTH,
"< 19", "20-24", "25-29", "30-34", "35-39", "40-44", "> 45")) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom")
# Installing required packages
packages <- c("tidyverse", "viridis")
to_install <- packages[!(packages %in% installed.packages()[,"Package"])]
if(length(to_install) > 0) install.packages(to_install)
lapply(packages, require, character.only = TRUE)
# Clean workspace
rm(list = ls())
# Set working directory
setwd("C:/Users/gustavoml/Desktop/Projects/FertilityFacts")
# Load intermediate datasets
total_fertility <- read.csv("refined/cps_total_fertility.csv")
mothers_1980_2022 <- read.csv("refined/cps_fertility_1980_2022.csv")
# Generating figures for Total Fertility by Age of First Birth and Educational Level
mothers_1980_2022 <- mothers_1980_2022 %>%
mutate(AGE_FIRST_BIRTH = fct_relevel(AGE_FIRST_BIRTH,
"< 19", "20-24", "25-29", "30-34", "35-39", "40-44", "> 45"))
total_fertility <- total_fertility %>%
mutate(AGE_FIRST_BIRTH = fct_relevel(AGE_FIRST_BIRTH,
"< 19", "20-24", "25-29", "30-34", "35-39", "40-44", "> 45"))
## Total Fertility by Age of First Birth
mothers_1980_2022 %>%
filter(YEAR %in% (2012:2022)) %>%
group_by(YEAR, AGE_FIRST_BIRTH) %>%
summarise(CHILDREN_PER_WOMAN = weighted.mean(FREVER, WTFINL)) %>%
ungroup() %>%
ggplot(aes(x = YEAR, y = CHILDREN_PER_WOMAN, color = AGE_FIRST_BIRTH)) +
geom_line() +
geom_point() +
theme_minimal()
## Total Fertility by Age of First Birth and Educational Level
total_fertility %>%
filter(YEAR %in% c(1980, 2022)) %>%
ggplot(aes(x = AGE_FIRST_BIRTH, y = CHILDREN_PER_WOMAN, fill = EDUCATIONAL_LEVEL)) +
geom_col(position = "dodge") +
facet_wrap(~ YEAR) +
labs(x = "Age",
y = "Children per woman",
fill = "Education:",
caption = "Source: Fertility Supplement of the Current Population Survey") +
theme_minimal() +
theme(legend.position = "bottom")
